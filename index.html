<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
	<script src="https://unpkg.com/intersection-observer@0.5.1/intersection-observer.js"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/scrollama/3.0.4/scrollama.min.js"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/d3/7.3.0/d3.min.js"></script>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link href="https://fonts.googleapis.com/css2?family=Bangers&family=Hanken+Grotesk:ital,wght@0,100..900;1,100..900&display=swap" rel="stylesheet">
	<link href="./style.css" rel="stylesheet" />
  </head>

  <body>
  <div class="header">
    <img src="./assets/rain-1.webp">
  </div>
  <div class="hero-content">
    <h1>Benny's holidays to Switzerland</h1>
    <p class="subhead">An organisational nightmare.</p>
  </div>
  <div class="editorial-container">
    <div class="editorial">
      <p>Benny is a Canadian living in Ottawa. He's pretty paranoid about safety and hates rain. So after a lot of research he's put together a data-driven guide to visiting Switzerland in the safest, and sunniest possible conditions.</p>
      <p>When, and where should Benny travel to?</p>
    </div>
  </div>
  <div class="spacer"></div>
  <section id="scrolly-images" class="scrolly-container">
    <div class="sticky-thing">
      <div class="sticky-inner">
        <img src="./assets/rain-1.webp">
      </div>
    </div>
    <div class="scrolly-overlay">
      <div class="step" id="step1">
        <div>
          <p>He looks at the precipitation sum per month for the last 20 years, with outlier months marked in yellow.</p>
        </div>
      </div>
      <div class="step" id="step2">
        <p>He also digs into rain records for different time periods. Most of these events happened in Ticino, so he won't be travelling there.</p>
        <p>Although these amounts are tiny compared to rain in India they do cause heavy floods.</p>
      </div>
      <div class="step">
        <p>Flood image</p>
      </div>
      <div class="step" id="step3">
        <p>Looking at the data, Benny won't be planning his visit to Switzerland in August. He'll probably go in March when it's snowing instead. Benny likes snow.</p>
      </div>
    </div>
  </section>


  <div class="editorial-container">
    <div class="editorial">
      <p>Benny feels pretty secure about his rain analysis, but is it safe to visit Switzerland in March? Benny looks into deaths from natural disasters in Switzerland over the last few decades to check which month and locations are safest.</p>
    </div>

    <section id="scroller" class="scrolly-container">
      <div class="sticky-thing">
        <div class="sticky-inner">
          <img src="./assets/disasters-2.webp">
        </div>
      </div>
      <div class="scrolly-overlay">
        <div class="step" id="step4">
          <div>
            <p>It seems August is also the most dangerous month, so Benny's feeling good about his earlier decision. To think that people plan holidays without looking at data... Crazy.</p>
            <p>March is one of the safest months and one of the least rainy, so he'll go then.</p>
          </div>
        </div>
        <div class="step" id="step5">
          <p>Looking at the data on deaths from natural disasters, Benny sees that total deaths from natural disasters have decreased, which is reassuring.</p>
        </div>
        <div class="step">
          <p>In March there are avalanches however, so he'll avoid all of the dark blue areas on the map for sure. He'll travel to a city, away from landslides and such nonsense.</p>
        </div>
      </div>
    </section>

    <div class="editorial">
      <p>At the end of his extremely long rabbit hole, Benny's decided to travel to Zurich in March.</p> 
      <p>He's feeling pretty smug about his trip when he realizes that he'll have to take a plane to get to Switzerland, Benny really doesn't like flying.</p>
      <div class="spacer"></div>
      <h3>Sources</h3>
      <ul>
        <li>
          <a href="https://www.envidat.ch/dataset/number-of-natural-hazard-fatalities-per-year-in-switzerland-since-1946" class="href">ENVIDAT</a>
        </li>
        <li>
          <a href="https://www.meteoswiss.admin.ch/climate/the-climate-of-switzerland/records-and-extremes.html" class="href">METEOSWISS</a>
        </li>
        <li>
          <a href="https://www.bfs.admin.ch/bfs/de/home/statistiken/querschnittsthemen/monitoring-legislaturplanung/alle-indikatoren/leitline-3-sicherheit/schaeden-naturereignisse.assetdetail.28485500.html" class="href">CH STATISTIKEN</a>
        </li>
        <li>
          <a href="https://meteostats.ch/?parameter=Precipitation&period=Year&display=Relative&reference-period=1991-2020&code=SWISS" class="href">METEOSTATS</a>
        </li>
        <li>
          <a href="https://www.wsl.ch/fr/dangers-naturels/comprendre-et-prevoir-les-crues/la-base-de-donnees-suisse-sur-les-dommages-dus-aux-intemperies/#" class="href">WSL</a>
        </li>
      </ul>
    </div>
  </div>

<script>  
// FIRST SCROLLY
d3.select("#step1").on('stepin', (e) => {
  d3.select(e.target.closest(".scrolly-container")).select("img").attr("src", "./assets/rain-1.webp")
})
d3.select("#step2").on('stepin', (e) => {
  d3.select(e.target.closest(".scrolly-container")).select("img").attr("src", "./assets/rain-2.webp")
})
d3.select("#step3").on('stepin', (e) => {
  d3.select(e.target.closest(".scrolly-container")).select("img").attr("src", "./assets/rain-3.webp")
})

// SECOND SROLLY
d3.select("#step4").on('stepin', (e) => {
  d3.select(e.target.closest(".scrolly-container")).select("img").attr("src", "./assets/disasters-2.webp")
})
d3.select("#step5").on('stepin', (e) => {
  d3.select(e.target.closest(".scrolly-container")).select("img").attr("src", "./assets/disasters-1.webp")
})


// SCROLLAMA AND SCROLLER SETUPS
const scrollerImg = scrollama();
const scroller = scrollama();

scrollerImg
  .setup({
    parent: document.querySelector("#scrolly-images"),
    step: ".step",
    offset: 0.6,
    debug: false,
  })
  .onStepEnter(function ({ element, index, direction }) {
    const event = new CustomEvent("stepin", { detail: { direction: direction } })
    element.dispatchEvent(event)
  })
  .onStepExit(function ({ element, index, direction }) {
    const event = new CustomEvent("stepout", { detail: { direction: direction } })
    if (direction === "up" && element.previousElementSibling) {
      const event = new CustomEvent("stepin", { detail: { direction: direction } })
      element.previousElementSibling.dispatchEvent(event)
    }
  })
  scroller
  .setup({
    parent: document.querySelector("#scroller"),
    step: ".step",
    offset: 0.6,
    debug: false,
  })
  .onStepEnter(function ({ element, index, direction }) {
    const event = new CustomEvent("stepin", { detail: { direction: direction } })
    element.dispatchEvent(event)
  })
  .onStepExit(function ({ element, index, direction }) {
    const event = new CustomEvent("stepout", { detail: { direction: direction } })
    if (direction === "up" && element.previousElementSibling) {
      const event = new CustomEvent("stepin", { detail: { direction: direction } })
      element.previousElementSibling.dispatchEvent(event)
    }
  })

</script>

  </body>
</html>
